#:set color_cosmos 0.2, 0, 0.1, 1

<MainScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: '30dp'
        spacing: '20dp'
        MDIconButton:
            icon: "cog"
            pos_hint: {"right": 1}
            on_release: root.manager.current = 'settings'
        Image:
            source: 'assets/images/rocket.png'
            size_hint_y: 0.5
        MDFillRoundFlatButton:
            text: "БИТВА НА ВИЖИВАННЯ"
            font_size: '22sp'
            size_hint_x: 1
            on_press:
                app.target_score = 0
                root.manager.current = 'game'
        MDFillRoundFlatButton:
            text: "ГРА НА ОЧКИ"
            font_size: '22sp'
            size_hint_x: 1
            md_bg_color: app.theme_cls.accent_color
            on_press:
                root.manager.current = 'game'
        Widget:
            size_hint_y: 0.1

<SettingsScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: '30dp'
        spacing: '20dp'
        MDLabel:
            text: "НАЛАШТУВАННЯ"
            halign: "center"
            font_style: "H4"

        MDBoxLayout:
            orientation: 'vertical'
            adaptive_height: True
            MDLabel:
                text: f"Ціль (Гра на очки): {int(slider_target.value)}"
            MDSlider:
                id: slider_target
                min: 5
                max: 100
                value: app.target_score
                on_value: app.target_score = int(self.value)

        MDBoxLayout:
            orientation: 'vertical'
            adaptive_height: True
            MDLabel:
                text: f"Чекпоїнт кожні: {int(slider_cp.value)} очок"
            MDSlider:
                id: slider_cp
                min: 10
                max: 50
                value: app.checkpoint_step
                on_value: app.checkpoint_step = int(self.value)

        Widget:
        MDRectangleFlatButton:
            text: "НАЗАД"
            size_hint_x: 1
            on_release: root.manager.current = 'main'

<Ship>:
    size_hint: None, None

<PlayerShip>:
    source: 'assets/images/rocket.png'
    size: dp(80), dp(100)

<EnemyShip>:
    source: 'assets/images/ufo.png'
    size: dp(60), dp(60)

<Shot>:
    size_hint: None, None
    size: dp(8), dp(15)
    canvas:
        Color:
            rgba: app.theme_cls.accent_color
        RoundedRectangle:
            pos: self.pos
            size: self.size
            radius: [dp(4),]

<VictoryScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: '50dp'
        spacing: '30dp'
        MDLabel:
            text: "ПЕРЕМОГА!"
            font_size: '50sp'
            halign: 'center'
            theme_text_color: "Custom"
            text_color: 0, 1, 0, 1
        MDLabel:
            text: f"Ви набрали {int(app.score)} очок"
            halign: 'center'
            font_style: "H5"
        MDRectangleFlatButton:
            text: "В ГОЛОВНЕ МЕНЮ"
            pos_hint: {'center_x': 0.5}
            on_press: root.manager.current = 'main'

<GameOverScreen>:
    MDBoxLayout:
        orientation: 'vertical'
        padding: '50dp'
        spacing: '30dp'
        MDLabel:
            text: "ГРА ЗАКІНЧЕНА"
            font_size: '50sp'
            halign: 'center'
            color: 1, 0, 0, 1
        MDRectangleFlatButton:
            text: "В ГОЛОВНЕ МЕНЮ"
            pos_hint: {'center_x': 0.5}
            on_press: root.manager.current = 'main'

<GameScreen>:
    MDFloatLayout:
        md_bg_color: color_cosmos
        MDFloatLayout:
            id: back
        MDFloatLayout:
            id: front
            PlayerShip:
                id: ship
                pos: root.center_x - self.width/2, dp(100)

        MDBoxLayout:
            orientation: 'horizontal'
            pos_hint: {"top": 1}
            size_hint_y: None
            height: dp(80)
            padding: dp(15)
            MDIconButton:
                icon: "exit-run"
                on_release: root.quit_to_menu()
            MDProgressBar:
                id: hp_status
                value: (ship.hp / ship.max_hp) * 100 if ship.max_hp > 0 else 0
            MDIconButton:
                icon: "pause"
                on_release: root.show_menu()

        MDLabel:
            text: f"РАХУНОК: {int(app.score)}"
            size_hint: None, None
            size: dp(200), dp(50)
            pos: dp(20), dp(20)
            theme_text_color: "Custom"
            text_color: 1, 1, 1, 1

        MDBoxLayout:
            size_hint: None, None
            width: dp(220)
            height: dp(80)
            pos_hint: {"right": 0.98, "y": 0.02}
            spacing: dp(10)
            MDFloatingActionButton:
                icon: "arrow-left"
                on_press: root.pressKey('left')
                on_release: root.releaseKey('left')
            MDFloatingActionButton:
                icon: "arrow-right"
                on_press: root.pressKey('right')
                on_release: root.releaseKey('right')
            MDFloatingActionButton:
                icon: "fire"
                md_bg_color: 1, 0, 0, 1
                on_press: root.pressKey('shot')
                on_release: root.releaseKey('shot')